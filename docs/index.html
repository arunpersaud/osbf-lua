<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <meta http-equiv="CONTENT-TYPE" content="text/html; charset=utf-8">









































  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <title>OSBF-Lua</title>
  <meta name="GENERATOR" content="OpenOffice.org 2.0 (Linux)">










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <meta name="CREATED" content="20050305;1494300">










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <meta name="CHANGEDBY" content="Fidelis Assis">










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <meta name="CHANGED" content="20060716;14264400">
</head>


<body style="direction: ltr; background-color: rgb(255, 255, 255);" lang="pt-BR">










































<table style="page-break-before: always;" border="0" cellpadding="2" cellspacing="0" width="100%">










































  <col width="41*"> <col width="174*"> <col width="41*"> <tbody>










































    <tr>










































      <td rowspan="3" width="16%"> <img src="osbf-lua_logo.png" name="OSBF-Lua logo" align="left" border="0" height="128" width="128"><br clear="left">










































      </td>










































      <td width="68%"></td>










































      <td width="16%"></td>










































    </tr>










































    <tr>










































      <td width="68%"><big> </big>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center"><big><big><b>OSBF-Lua<br>





      </b></big></big></p>






      




































       </td>










































      <td width="16%">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p style="height: 29px;" align="center"><br>










































      </p>










































      </td>










































    </tr>










































    <tr valign="top">










































      <td width="68%">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      




































      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center">Text classification module for the
      <a href="http://www.lua.org/">Lua</a>
Programming Language<br>





and a production class anti-spam&nbsp;in Lua using the module</p>





      
      
      
      
      
      <p align="center"><big><big><b><small style="font-style: italic; color: rgb(102, 102, 102);">Winner of TREC's Spam Track 2006</small></b></big></big></p>





      
      
      
      
      
      <p align="center"><big><big><b><small style="font-style: italic; color: rgb(102, 102, 102);"></small></b></big></big> </p>










































      </td>










































      <td width="16%">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center"><br>










































      </p>










































      </td>










































    </tr>










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>










































<p align="center"><a href="#over"><font face="Bitstream Vera Sans">Overview&nbsp;</font></a>
<font face="Bitstream Vera Sans">&middot;&nbsp; </font><a href="#whatsnew"><font face="Bitstream Vera Sans">What's
new&nbsp;</font></a> <font face="Bitstream Vera Sans">&middot;
&nbsp;</font><a href="#download"><font face="Bitstream Vera Sans">Download and Contributions&nbsp;</font></a>
<font face="Bitstream Vera Sans">&middot; &nbsp;</font><a href="#installation"><font face="Bitstream Vera Sans">Installation</font></a>&nbsp;
<font face="Bitstream Vera Sans">&middot; &nbsp;</font><a href="manual.html"><font face="Bitstream Vera Sans">Manual&nbsp;</font></a>
<font face="Bitstream Vera Sans">&middot; &nbsp;</font><a href="#credits"><font face="Bitstream Vera Sans">Credits&nbsp;</font></a>
<font face="Bitstream Vera Sans">&middot; &nbsp;</font><a href="#contact"><font face="Bitstream Vera Sans">Contact</font></a>
</p>










































<hr>
<h3><a name="over"></a><b><br>





Overview</b></h3>










































<p align="left">OSBF-Lua
(<b>O</b>rthogonal <b>S</b>parse <b>B</b>igrams
with confidence
<b>F</b>actor) is a <a href="http://www.lua.org/">Lua</a>
C module for text classification. It
is a port of the OSBF classifier implemented in the <a href="http://crm114.sourceforge.net/">CRM114</a>
project. This implementation
attempts to put focus on the classification task itself by using Lua
as the scripting language, a powerful yet light-weight and fast
language, which makes it easier to build and test more elaborated
filters and training methods.</p>










































<p style="" align="left">The
OSBF algorithm is a typical Bayesian classifier but enhanced with two
techniques that I originally developed for the CRM114 project:
<i>Orthogonal Sparse Bigrams</i> - <i>OSB</i>,
for feature
extraction, and&nbsp;<i>Exponential Differential Document Count</i>
-
<i>EDDC</i> (a.k.a <i>Confidence Factor</i>),
for automatic feature
selection. Combined, these two techniques produce a highly accurate
classifier. OSBF was developed focused on two classes, SPAM and
NON-SPAM, so the performance for more than two classes may not be the
same.</p>






<p style="" align="left"><span style="font-style: italic;">spamfilter.lua</span> is
an anti-spam filter written in&nbsp;Lua&nbsp;using the OSBF-lua
module.&nbsp; It takes special advantage of EDDC to introduce <a href="../../papers/trec2006_osbf_lua.pdf">TONE-HR</a>,
a&nbsp;highly effective training method.&nbsp;The combination of OSB, EDDC and
TONE-HR to enhance a classical Bayesian classifier resulted in the best spam filtering performance&nbsp;in <a href="http://Link_Not_Yet_Available">TREC's Spam Track 2006</a>.</p>






The
<i>Confidence Factor</i> was officially introduced in the
paper
<a href="http://osbf-lua.luaforge.net/papers/osbf-eddc.pdf"><i>"Exponential
Differential Document Count - A Feature Selection Factor for
Improving Bayesian Filters Accuracy"</i></a>,
presented in the <a href="http://www.spamconference.org/">MIT
Spam Conference</a> - 2006,
after being in experimental use for more than a year in both
projects: CRM114 and OSBF-Lua. The <a href="http://osbf-lua.luaforge.net/papers/osbf-eddc_slides.pdf">conference
slides </a>are also
available.




































<p>The OSB technique
was officially announced in the paper <a href="http://www.siefkes.net/ie/winnow-spam.pdf"><i>"Combining
Winnow with Orthogonal Sparse Bigrams for Incremental Spam
Filtering"</i></a>,
a work headed and presented by <a href="http://www.siefkes.net/">Christian
Siefkes</a> in
the 8<sup>th</sup> <i>European Conference on
Principles and Practice
of Knowledge Discovery in Databases (PKDD)</i>, on September 2004.</p>










































<p>The CRM114
implementation of OSBF was one of the classifiers submitted to the
<a href="http://plg.uwaterloo.ca/%7Egvcormac/trecspamtrack05/">TREC's&nbsp;Spam Track 2005</a>&nbsp; by the
CRM114 team, but its first results were not good because of a bug.
Later, the bug was fixed and the OSBF-Lua version was submitted to
the track coordinator, prof. <a href="http://plg.uwaterloo.ca/%7Egvcormac/">Gordon
Cormack</a>, for an extra
evaluation. The new <a href="http://osbf-lua.luaforge.net/TREC2005/">results</a>
were comparable to those of the best
participants, with the advantage of being 5 to 10 times faster. Our
<a href="http://osbf-lua.luaforge.net/papers/NIST_TREC_2005_paper.pdf">notebook
paper</a> comments on the
results of the four filters submitted by the CRM114 team: OSBF,
Winnow, OSB Unique and OSB.</p>










































<p>OSBF-Lua is free
software and is released under the GPL version 2. You can get a copy
of the license at <a href="http://www.fsf.org/licensing/licenses/gpl.txt">GPL</a>.
This <span lang="en-US">distribution</span>
includes a copy of the
license in the file gpl.txt.<br>










































<font size="4"><font face="Bitstream Vera Sans"><br>










































</font></font></p>










































<h3><a name="download"></a>&nbsp;Download and Contributions</h3>










































<ul>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">The sources can be
downloaded from <a href="http://luaforge.net/projects/osbf-lua">LuaForge</a></p>




  </li>




  <li>Cassiano Aquino
maintains&nbsp;an OSBF-Lua <a href="http://ebrain.com.br/%7Ecassiano/dists/unstable/free/binary-i386/">package
for Debian</a></li>




  <li>Steve Pellegrin
maintains a <a href="http://www.convoglio.com/osbf-lua/">SquirrelMail plugin</a> for OSBF-Lua</li>










































  




































  





































  <li>


  Christian Siefkes wrote a <a href="http://www.siefkes.net/software/trainfilter/">Perl script</a>&nbsp;that makes the training process much easier. He also has a&nbsp;tutorial on how to install the filter&nbsp;locally</li>




  <li>Marlon Cabrera&nbsp;shows how to&nbsp;integrate <a href="http://www.mrgnetwork.com.br/wiki/doku.php?id=howtos">OSBF-Lua and Exim
    </a></li>




  <li>


  Diego Aguirre has a <a href="http://www.iltc.br/%7Eaguirre/osbflua-ow/index_en.html">patch for Openwebmail</a> to add training buttons<br>





    <br>





  </li>










































</ul>










































<h3><a name="whatsnew"></a>&nbsp;What's
new</h3>










































<ul>












  <li>[14/Jan/2007 Version 2.0.4<br>










    <br>











  </li>











  
  
  
  
  
  
  
  
  
  
  
  <ul>











    <li>Changes to osbf module</li>











    
    
    
    
    
    
    
    
    
    
    
    <ul>











      <li>Removed unnecessary linking of liblua.a, which caused
segfaults on&nbsp; IRIX 6.5.30. This fix also reduced the size of the
module by a factor of 5. Problem detected and fixed by Holger Weiss;</li>











      <li>Fixed the number of args returned by osbf.classify in case of error;<br>










        <br>











      </li>











    
    
    
    
    
    
    
    
    
    
    
    </ul>











    <li>Changes to spamfilter.lua</li>











    
    
    
    
    
    
    
    
    
    
    
    <ul>











      <li>Added <span style="font-family: monospace;">--help</span> option;</li>











      <li>Extended syntax to read from file passed as arg in command line. If no file is given, it reads from standard input as usual;</li>











      <li>Better error handling;</li>











      <li>Fixed <span style="font-family: monospace;">optind</span> in getopt.lua.</li>











      <br>











    
    
    
    
    
    
    
    
    
    
    
    </ul>











    <li>Fixed a date parsing error in <span style="font-family: monospace;">cache_report.lua</span>, caused mainly by ill-formed date fields in spam messages;<br>











    </li>











    
    
    
    
    
    
    
    
    
    
    
    <ul>











      <br>











    
    
    
    
    
    
    
    
    
    
    
    </ul>











    <li>The scripts <span style="font-family: monospace;">classify.lua</span> and <span style="font-family: monospace;">train.lua</span> were renamed to <span style="font-family: monospace;">classify.sample</span> and <span style="font-family: monospace;">train.sample</span>, because they are meant more as samples, or starting points for customized scripts, than for real use. <span style="font-family: monospace;">spamfilter.lua</span> should be used for real classifications and trainings;<br>











    </li>











    
    
    
    
    
    
    
    
    
    
    
    <ul>











      <br>











    
    
    
    
    
    
    
    
    
    
    
    </ul>











    <li>Added the file <span style="font-family: monospace;">HISTORY_AND_AGREEMENT</span> which states the dual-license agreement between Fidelis Assis and William Yerazunis.<br>











    </li>











    
    
    
    
    
    
    
    
    
    
    
    <ul>











    
    
    
    
    
    
    
    
    
    
    
    </ul>











  
  
  
  
  
  
  
  
  
  
  
  </ul>











</ul>











<ul>











  <li>
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">See the full <a href="CHANGES">CHANGES<br>










































    </a><font size="4"><font face="Bitstream Vera Sans"><a href="CHANGES"><br>










































    </a></font></font></p>










































  </li>










































</ul>










































<h3><a name="installation"></a>Installation</h3>










































<p>OSBF-Lua requires
Lua 5.1 installed with dynamic loading enabled. OSBF-Lua was
developed and tested under the Lua 5.1 work, alpha, beta and final
5.1 versions. It probably won't work with previous versions.</p>










































<p>Installation steps:</p>










































<ul>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">Install Lua with
dynamic loading enabled:</p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;">For linux, execute
"make linux" and "make install". For other OS, read the instructions in
the INSTALL file and your OS documentation on how to create shared libs.</p>










































      </li>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;">You might want to
change the occurrences of the O2 flag in CFLAGS to O3, in all
makefiles, for increased speed.</p>










































      </li>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































</ul>







































































<ul>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">Install the OSBF-Lua
module:</p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>$ tar
xvzf osbf-lua-x.y.z.tar.gz</code></p>










































      </li>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>$ cd
osbf-lua-x.y.z</code></p>










































      </li>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><font face="Bitstream Vera Sans">edit the "config" file to suit to
your platform - not necessary for Linux - or to change the default installation PREFIX dir (/usr/local).</font></p>










































      </li>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>$ make</code></p>










































      </li>










































      <li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>#&nbsp;make
install</code><br>










































        </p>










































      </li>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































</ul>










































<p style="margin-bottom: 0cm;">If you want to install in the default dir you
must be root to do the "make install" step. If you don't
have root access, you may set <span style="font-family: monospace;">PREFIX</span>&nbsp;to point to a dir you have write access to, for instance <span style="font-family: monospace;">$HOME/lib</span>. You&nbsp;need to add the new installation dir to <span style="font-family: monospace;">LUA_CPATH</span> so that Lua loader can find <span style="font-family: monospace;">osbf.so</span>.&nbsp;</p>













<p style="margin-bottom: 0cm;"> Ex: Installing in <span style="font-family: monospace;">$HOME/lib</span><br>










































</p>













<p style="margin-bottom: 0cm;">&lt;edit config and set <span style="font-family: monospace;">PREFIX</span> to&nbsp;<span style="font-family: monospace;">$HOME/lib</span>&gt;</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>$ mkdir
$HOME/lib</code></p>













<p style="margin-bottom: 0cm; font-family: monospace;"><code>$ make install</code></p>







































































<p style="margin-bottom: 0cm; font-family: monospace;"><code>$ export LUA_CPATH=$HOME/lib/?.so:</code><code>$LUA_CPATH</code><br>










<code>































<br>










































</code></p>










































<p style="margin-bottom: 0cm;">After&nbsp;osbf module
is properly installed, you may want to install the
spamfilter, a Lua script that uses the OSBF-Lua module to classify
and tag messages as spam or non-spam (ham) according to the score
they get, or to the white/blacklists, if any:<br>










































</p>










































<p style="margin-bottom: 0cm;"><code>&nbsp;make
install_spamfilter</code><br>










































</p>










































<p style="margin-bottom: 0cm;">The
spamfilter files are installed in /usr/local/osbf-lua. If the dir
doesn't exist it'll be created</p>










































<p style="margin-bottom: 0cm;">The
next step is to configure your email account to use the spamfilter:</p>










































<ul>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">do the following steps
under your account, not as root</p>










































  </li>










































</ul>










































<ul>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;"><font face="Bitstream Vera Sans">create your local osbf-lua dir:</font></p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul style="font-family: monospace;">










































      <big> </big><li><big> </big>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm; font-family: monospace;"><code>mkdir
$HOME/osbf-lua</code></p>










































        <big> </big></li>










































      <big> </big>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;"><font face="Bitstream Vera Sans">create your log and cache dirs:</font></p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul style="font-family: monospace;">










































      <big> </big><li><big> </big>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>mkdir
$HOME/osbf-lua/log</code></p>










































        <code><big> </big></code></li>










































      <code><big> </big></code><li><code><big>
        </big></code>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>mkdir
$HOME/osbf-lua/cache<br>



























        <br>



























        <span style="font-style: italic;">Note: Old messages in the cache dir should be deleted regularly, typically&nbsp;from a cron job, to preserve disk space.</span></code><code><span style="font-style: italic;"> Check Christian Siefkes' <a href="http://www.siefkes.net/software/trainfilter/">trainfilter</a> for his clean-up script.</span></code></p>










































        <big> </big></li>










































      <big> </big>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">copy the spamfilter
config file to your dir:</p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul style="font-family: monospace;">










































      <big> </big><li><big> </big>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm;"><code>cp
/usr/local/osbf-lua/spamfilter_config.lua $HOME/osbf-lua</code></p>










































        <big> </big></li>










































      <big> </big>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">edit
spamfilter_config.lua to set your password</p>










































  </li>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">change the current dir
to your osbf-lua dir and create the spamfilter databases (<span style="font-family: monospace;">spam.cfc</span> and <span style="font-family: monospace;">nonspam.cfc</span>)</p>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <ul>










































      <li style="font-family: monospace;"><big> </big>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm; font-family: monospace;">cd
$HOME/osbf-lua</p>










































        <big style="font-family: monospace;"><big> </big></big></li>










































      <li style="font-family: monospace;"><big style="font-family: monospace;"> </big>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <p style="margin-bottom: 0cm; font-family: monospace;">lua
/usr/local/osbf-lua/create_databases.lua # change '/usr/local' to your PREFIX</p>










































        <big> </big></li>










































    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    </ul>










































  </li>










































  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">add the following lines
to your .procmailrc</p>










































  </li>










































</ul>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>#
set OSBF_LUA_DIR to where spamfilter.lua, spamfilter_command.lua etc
were installed</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>OSBF_LUA_DIR=/usr/local/osbf-lua # change '/usr/local' to your&nbsp;PREFIX</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>OSBF_LUA_USER_DIR=$HOME/osbf-lua</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>#
let the Lua interpreter find the "osbf" module. </code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>#
uncomment if you installed a local copy of the osbf module (e.g. no
root access)</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>#LUA_CPATH=$LUA_CPATH:$HOME/lib/?.so</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code><br>










































</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>:0fw:
.msgid.lock</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>*
&lt; 350000 # don't check messages greater than 350000 bytes</code></p>










































<p style="margin-left: 2.01cm; margin-bottom: 0cm; font-family: monospace;"><code>|
</code><code>$OSBF_LUA_DIR/spamfilter.lua&nbsp;--udir $OSBF_LUA_USER_DIR</code><code> </code></p>










































<ul>










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  




























  <li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p style="margin-bottom: 0cm;">OBS: The "osbf-lua" dir
and all files and dirs under it must be writable by the user or group
that procmail runs under. </p>










































  </li>










































</ul>







































































<p style="margin-bottom: 0cm;">Check
your installation by sending a message to yourself with the following
command in the subject line:</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>help
&lt;your password&gt;</code></p>










































<p style="margin-bottom: 0cm;">You
should receive a message with a help on the spamfilter. Then, send
another command in the subject line to verify that the databases were
created correctly:</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>stats
&lt;your password&gt;</code></p>










































<p style="margin-bottom: 0cm;">You
should get a statistics report on the just created databases.</p>










































<p style="margin-bottom: 0cm;">From
now on, all messages you receive with less than max size specified in
the procmail recipe will be classified and tagged according to the
score they get:</p>










































<p style="margin-bottom: 0cm;"><br>










































</p>










































<table style="page-break-inside: avoid;" border="1" cellpadding="4" cellspacing="3" width="707">










































  <col width="88"> <col width="592"> <thead>
  <tr valign="top">










































    <td width="88">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p align="center"><font face="Bitstream Vera Sans">Tag</font></p>










































    </td>










































    <td width="592">
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <p align="center">Meaning</p>










































    </td>










































  </tr>










































  </thead> <tbody>










































    <tr valign="top">










































      <td width="88">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center">[--]</p>










































      </td>










































      <td width="592">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p>almost sure it's a spam - score &lt;= -20</p>










































      </td>










































    </tr>










































    <tr valign="top">










































      <td width="88">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center">[-]</p>










































      </td>










































      <td width="592">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p>probably it's a spam (reinforcement zone) - score
&lt; 0 and &gt; -20</p>










































      </td>










































    </tr>










































    <tr valign="top">










































      <td width="88">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center">[+]</p>










































      </td>










































      <td width="592">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p>probably it's not spam (reinforcement zone) - score
&gt;=0 and &lt; 20</p>










































      </td>










































    </tr>










































    <tr valign="top">










































      <td width="88">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center">[++]</p>










































      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p align="center"><br>










































      </p>










































      </td>










































      <td width="592">
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <p>almost sure it's not spam - score &gt;= 20. This tag
is here just for symmetry, it's not used. An empty tag is used in place
of it so as not to pollute the messages.</p>










































      </td>










































    </tr>










































  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  </tbody>
</table>







































































<p style="margin-bottom: 0cm;"></p>













<p style="margin-bottom: 0cm;">If
the classification is wrong you must train the filter replying (you
must do a "Reply", not a "Forward") the message
back to yourself, replacing the subject with the correspondent
training command:</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>learn
&lt;password&gt; spam</code></p>










































<p style="margin-bottom: 0cm;">or</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>learn
&lt;password&gt; nonspam</code></p>










































<p style="margin-bottom: 0cm;">The
body of the message may be erased, it's not required. The original
message, temporarily saved on the server by the spamfilter, will be
recovered through the SFID (Spam Filter ID), a special mark added to
the header when the message arrived to the server.</p>










































<p style="margin-bottom: 0cm;">If
you make a mistake, you should undo the training with the command
"unlearn". Ex:</p>










































<p style="margin-bottom: 0cm; font-family: monospace;"><code>unlearn
&lt;password&gt; spam</code></p>










































<p style="margin-bottom: 0cm;">if
wrongly trained as spam.</p>










































<p style="margin-bottom: 0cm;">Training
when the classification is wrong is essential for accuracy. Training
when in the reinforcement zone, called <i>reinforcement</i>,
is
highly recommended for increasing and keeping the accuracy
high. After you have a well trained filter, say 99% or better
accuracy, you may want to reduce the reinforcement zone, eg. [-10,
10], so as not to do many reinforcements a day. You may change the
reinforcement zone, tags, etc, by editing the file <span style="font-style: italic;">spamfilter_config.lua</span>.<br>












<br>










































</p>










































<h3><a name="credits"></a>Credits</h3>










































<p>The OSBF-Lua lib and
spamfilter.lua were designed and implemented by Fidelis Assis, who
holds&nbsp;the primary copyright. </p>










































The OSB technique,
as well as the OSBF classify and learn codes are based on the OSB and
OSBF I originally developed for the CRM114 project, as a derivative
work based on Bill Yerazunis' CRM114 Markovian classifier. Bill
Yerazunis holds the secondary copyright&nbsp;on the OSBF-Lua lib.<br>



















































































<h3><a name="contact"></a>Contact</h3>










































<p>For more information
please <a href="mailto:fidelis-NO-SPAM-THANKS@pobox.com">email
me</a>.
Comments are welcome! </p>










































<hr>
</body>
</html>
